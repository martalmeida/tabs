function dot(a,b){return a.x*b.x+a.y*b.y}function norm2(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))}function norm(a){return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))}function somVect(a,b){var c=new Object,d=a.x+b.x,e=a.y+b.y;return c.x=d,c.y=e,c}function prodScalar(a,b){var c=new Object,d=a.x*b,e=a.y*b;return c.x=d,c.y=e,c}function getColorSalinity(a){return 0==a?"#2b136f":5==a?"#2c1b86":8==a?"#183a95":11==a?"#08558d":14==a?"#1a6a88":17==a?"#2e7d87":20==a?"#3e9187":23==a?"#4ea684":26==a?"#64ba7b":29==a?"#88cc6e":32==a?"#bdda70":35==a?"#eae69e":"#cccccc"}function getColorTemperature(a){return 0==a?"#032333":20==a?"#082d54":20.5==a?"#39339d":21==a?"#6c4594":21.5==a?"#985789":22==a?"#c86675":22.5==a?"#f07e50":23==a?"#fbac3c":23.5==a?"#f2e04d":"#e7fa5a"}function getColorSpeed(a){return 0==a?"#efebf4":.22==a?"#e0d4e8":.44==a?"#d1b0d5":.66==a?"#cb8fc4":.88==a?"#df64af":1.11==a?"#e62f8e":1.33==a?"#d31761":1.55==a?"#a90549":1.77==a?"#7c002e":"#000"}function legendTemperature(){for(var d,e,a=L.DomUtil.create("div","info legend leaflet-control"),b=["0","20.0","20.5","21.0","21.5","22.0","22.5","23.0","23.5","24.0","100"],c=[],f=b.length-2;f>=0;f--)d=b[f],e=b[f+1],0==f?c.push('<i style="background:'+getColorTemperature(d)+'"></i> &lt'+e):f==b.length-2?c.push('<i style="background:'+getColorTemperature(d)+'"></i> &gt'+d):c.push('<i style="border-bottom: 0px solid white;background:'+getColorTemperature(d)+'"></i> '+d+"&ndash;"+e);return a.id="temperature_legend",a.innerHTML=c.join("<br>"),a.innerHTML+='<div id="opacityslidertemperature"></div>',a}function legendSalinity(){for(var d,e,a=L.DomUtil.create("div","info legend leaflet-control"),b=[0,5,8,11,14,17,20,23,26,29,32,35],c=[],f=0;f<b.length;f++)d=b[f],e=b[f+1],0==f?c.push('<i style="background:'+getColorSalinity(d)+'"></i> &lt'+e):f==b.length-1?c.push('<i style="background:'+getColorSalinity(d)+'"></i> &gt'+d):c.push('<i style="border-bottom: 0px solid white;background:'+getColorSalinity(d)+'"></i> '+d+"&ndash;"+e);return a.id="salinity_legend",a.innerHTML=c.join("<br>"),a.innerHTML+='<div id="opacityslidersalinity"></div>',a}function legendSpeed(){for(var d,e,a=L.DomUtil.create("div","info legend leaflet-control"),b=[0,.22,.44,.66,.88,1.11,1.33,1.55,1.77,2],c=[],f=0;f<b.length;f++)d=b[f],e=b[f+1],0==f?c.push('<i style="background:'+getColorSpeed(d)+'"></i> &lt'+e):f==b.length-1?c.push('<i style="background:'+getColorSpeed(d)+'"></i> &gt'+d):c.push('<i style="border-bottom: 0px solid white;background:'+getColorSpeed(d)+'"></i> '+d+"&ndash;"+e);return a.id="speed_legend",a.innerHTML=c.join("<br>"),a.innerHTML+='<div id="opacitysliderspeed"></div>',a}function checkLegendsToShow(a){var b=$("input[class=leaflet-control-layers-selector]:checked").parent().text().toLowerCase();$("#salinity_legend").toggle(mapView.visibleLayers.salinity&&b.indexOf("salinity")>=0),$("#temperature_legend").toggle(mapView.visibleLayers.temperature&&b.indexOf("temperature")>=0),$("#speed_legend").toggle(mapView.visibleLayers.speed&&b.indexOf("speed")>=0),$("#opacityslidersalinity").slider({value:a}),$("#opacityslidertemperature").slider({value:a}),$("#opacitysliderspeed").slider({value:a}),$("#salinity_legend > i").css("opacity",a),$("#temperature_legend > i").css("opacity",a),$("#speed_legend > i").css("opacity",a)}$(function(){$(".leaflet-bottom.leaflet-right>.leaflet-control-attribution").before(legendSalinity()),$(".leaflet-bottom.leaflet-right>.leaflet-control-attribution").before(legendTemperature()),$(".leaflet-bottom.leaflet-right>.leaflet-control-attribution").before(legendSpeed()),checkLegendsToShow(Config.opacityLegend),$("#opacityslidersalinity").slider({min:10,max:100,value:100,step:1,change:function(a,b){},slide:function(a,b){Config.opacityLegend=b.value;var c=b.value/100;$("svg").css("opacity",c),$("#salinity_legend > i").css("opacity",c)}}),$("#opacityslidertemperature").slider({min:10,max:100,value:100,step:1,change:function(a,b){},slide:function(a,b){Config.opacityLegend=b.value;var c=b.value/100;$("svg").css("opacity",c),$("#temperature_legend > i").css("opacity",c)}}),$("#opacitysliderspeed").slider({min:10,max:100,value:100,step:1,change:function(a,b){},slide:function(a,b){Config.opacityLegend=b.value;var c=b.value/100;$("svg").css("opacity",c),$("#speed_legend > i").css("opacity",c)}}),$("#opacityslidersalinity").mousedown(function(){mapView.map.dragging.disable()}),$("#opacityslidertemperature").mousedown(function(){mapView.map.dragging.disable()}),$("#opacitysliderspeed").mousedown(function(){mapView.map.dragging.disable()}),$("#opacityslidersalinity").mouseup(function(){var a=$("#opacityslidersalinity").slider("option","value");$("#opacityslidertemperature").slider({value:a}),$("#opacitysliderspeed").slider({value:a})}),$("#opacityslidertemperature").mouseup(function(){var a=$("#opacityslidertemperature").slider("option","value");$("#opacityslidersalinity").slider({value:a}),$("#opacitysliderspeed").slider({value:a})}),$("#opacitysliderspeed").mouseup(function(){var a=$("#opacitysliderspeed").slider("option","value");$("#opacityslidertemperature").slider({value:a}),$("#opacityslidersalinity").slider({value:a})}),$("input[class=leaflet-control-layers-selector]").change(function(){checkLegendsToShow(Config.opacityLegend),mapView.redraw()}),$(".leaflet-slider-minus").click(function(){var a=$("#leaflet-slider").slider("value"),b=a>0?a-1:0;$("#leaflet-slider").slider("value",b),mapView.showTimeStep(b)}),$(".leaflet-slider-plus").click(function(){var a=$("#leaflet-slider").slider("value"),b=a<mapView.nFrames?a+1:mapView.nFrames;$("#leaflet-slider").slider("value",b),mapView.showTimeStep(b)}),$("label>span").each(function(a){if("None"!=$(this).html().trim()){var b=["Salinity","Temperature","Speed"].indexOf($(this).html().trim())>-1,c=b?"s":"v";$(this).prepend('<img src="imgs/'+c+'field_32.png" class="leaflet-control-icons" alt="" />')}})});